# Отчёт об инциденте DDoS ICMP Flood

**NIST Cybersecurity Framework 2.0 / Уровень: Enterprise SOC**
**Аналитик:** dedinkorea • **Дата:** декабрь 2025 • **TLP:** WHITE
**Период недоступности сервисов:** 120 минут

---

## 1. Краткое описание инцидента

Атака типа **ICMP Flood (ICMP Echo Request, type 8)** была проведена на внешний периметр. Из-за отсутствия ограничений на ICMP-трафик и слабой фильтрации по источникам произошла деградация внутренней сети: маршрутизатор достиг 100% загрузки CPU, сервисы стали недоступны.

Тип атаки: **Volumetric DDoS**
Источник: распределённая ботнет-сеть (вероятно, 3–5K узлов)
Последствие: полная недоступность бизнес-сервисов в течение **2 часов**

---

## 2. Identify (Идентификация)

Основные выявленные проблемы:

* Не было полного учёта внешних потоков ICMP.
* ICMP echo-request был разрешён всем внешним IP без rate-limit.
* Отсутствие Threat-Modeling по DDoS-угрозам.
* Ненастроенный контроль spoofed IP.
* Нет Runbook/Playbook по Layer3 DDoS.

**Уязвимость уровня:** архитектурная, сетевой периметр.

---

## 3. Protect (Защита)

### Краткий план внедрения защитных мер

| Мера                                                          | Приоритет | Дедлайн    |
| ------------------------------------------------------------- | --------- | ---------- |
| Ограничить ICMP трафик до 5–10 pps/hop                        | P0        | немедленно |
| Запрет внешних ICMP Echo (type 8)                             | P0        | немедленно |
| Anti-Spoofing (BCP 38) на границе                             | P0        | 48 часов   |
| Внедрение DDoS-защиты: Cloudflare Magic Transit / AWS Shield  | P1        | 7 дней     |
| GeoIP-фильтрация по Threat-Intel                              | P1        | 7 дней     |
| Ограничение throughput на интерфейсы без критических сервисов | P1        | 7 дней     |
| Полное обновление правил Firewall по ICMP                     | P1        | 7 дней     |

---

## 4. Detect (Обнаружение)

Настроенные и предложенные механизмы детектирования:

* **NetFlow/NTA** – алерты на аномальный всплеск ICMP пакетов.
* **Suricata IDS** – правила из Emerging Threats на ICMP Flood.
* **SIEM-корреляция:**

  ```
  icmp.type == 8 AND volume > baseline × 50
  ```
* Активация алертов DDoS у облачного провайдера.
* Мониторинг CPU/Buffer на edge-роутерах.

**Среднее время детектирования:** 2 минуты после начала атаки.

---

## 5. Respond (Реагирование)

Фактические и оптимизированные действия:

1. Автоматическая блокировка сети-источника через **BGP FlowSpec**.
2. Перенаправление трафика в **scrubbing-центр**.
3. Отключение некритичных сервисов для снижения нагрузки.
4. Сбор доказательной базы: PCAP, NetFlow, firewall-логи.
5. Уведомление руководства, провайдера и владельцев сервисов.
6. Создание события в SIEM / формирование Case.

**MTTR (время устранения):** ~90 минут

---

## 6. Recover (Восстановление)

Шаги восстановления после атаки:

1. Постепенное снятие ограничений ICMP.
2. Возврат сервисов к штатной нагрузке.
3. Перепроверка маршрутизаторов, таблиц флоу, CPU/RAM.
4. Митинг Lessons Learned в течение 72 часов.
5. Обновление Playbook, Runbook и документации по DDoS.

**Статус после инцидента:** сеть работает стабильно.

---

## 7. Lessons Learned (Выводы)

**Что было сделано хорошо:**

* Быстрый детект благодаря NetFlow.
* Корректное перенаправление трафика в scrubbing-центр.

**Что необходимо улучшить:**

* Периметр не должен принимать ICMP извне.
* Требуется централизованная DDoS-защита уровня L3/L4.
* Нужен формальный процесс Threat-Modeling.
* Необходимо заранее иметь Runbook на volumetric DDoS.
* Надо вести baseline трафика по всем протоколам.

**Что внедрено после инцидента:**

* Полная фильтрация ICMP.
* FlowSpec автоматизирован.
* Добавлены SIEM-корреляции.
* Обновлён Playbook SOC по DDoS.

---

## 8. Приложения

* PCAP с примерами ICMP Flood
* Скриншоты NetFlow и Suricata Alerts
* Фрагменты логов edge-firewall
* Обновлённая конфигурация Firewall/FlowSpec
