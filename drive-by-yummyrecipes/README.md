# Анализ инцидента: Drive-by Compromise через скомпрометированный легитимный веб-сайт

**Тип инцидента:** Компрометация публично доступного веб-приложения  
**Дата анализа:** декабрь 2025  

### Описание инцидента
Легитимный веб-сайт yummyrecipesforme.com был скомпрометирован в результате успешной атаки brute-force на административную панель (использовались учётные данные по умолчанию).  
Атакующий модифицировал исходный код страницы, внедрив вредоносный JavaScript, который инициировал client-side перенаправление пользователей на контролируемый злоумышленником домен greatrecipesforme.com.

### Индикаторы компрометации (IOCs)
| Тип              | Значение                          |
|------------------|-----------------------------------|
| Легитимный домен | yummyrecipesforme.com → 203.0.113.22 |
| Злонамеренный домен | greatrecipesforme.com → 192.0.2.17 |
| Протоколы        | DNS (порт 53), HTTP (порт 80)     |
| TLS/HTTPS        | Отсутствует                       |

### Хронология событий (на основе PCAP)
| Время         | Событие                                                                 |
|---------------|-------------------------------------------------------------------------|
| 14:18:32      | Успешное разрешение и HTTP-соединение к yummyrecipesforme.com          |
| 14:20:32      | Неинициированный клиентом DNS-запрос к greatrecipesforme.com          |
| 14:25:29      | Установление TCP-соединения и выполнение HTTP GET к злонамеренному домену |

**Вывод по трафику:** Признаков Man-in-the-Middle, ARP/DNS-spoofing не обнаружено. Перенаправление выполнено на стороне клиента (JavaScript).

### Соответствие MITRE ATT&CK
- T1078 — Valid Accounts (использование дефолтных учётных данных)
- T1190 — Exploit Public-Facing Application
- T1189 — Drive-by Compromise

### Root Cause
Успешная атака brute-force на административную панель по причине использования учётных данных по умолчанию → несанкционированная модификация веб-контента → внедрение вредоносного кода.

### Рекомендации по устранению и предотвращению
1. Немедленная смена всех учётных данных по умолчанию и введение политики паролей (мин. 16 символов, сложность)
2. Включение многофакторной аутентификации (MFA/2FA) для всех административных учётных записей
3. Развёртывание веб-application firewall (Cloudflare, ModSecurity + OWASP CRS)
4. Принудительное использование HTTPS с заголовками HSTS и Content-Security-Policy
5. Внедрение системы мониторинга целостности файлов (Wazuh, OSSEC, Tripwire)
6. Защита от атак brute-force (Fail2ban, Cloudflare Firewall Rules, rate-limiting)

### Приложенные материалы
- [yummy_defacement.pcapng](yummy_defacement.pcapng) — полный захват трафика (Wireshark/tcpdump)

---
Данный кейс демонстрирует навыки анализа сетевого трафика, идентификации client-side атак и подготовки рекомендаций уровня L1/L2 SOC analyst.
